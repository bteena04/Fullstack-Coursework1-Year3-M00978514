<!--Index.html-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./css/styles.css" />
    <title>XLearning</title>
  </head>
  <body>
    <!--Vue app-->
    <div id="app">
      <!--Navbar.-->
      <div id="navbar">
        <nav
          class="navbar navbar-expand-lg bg-body-tertiary"
          :data-bs-theme="darkMode ? 'dark' : 'light'"
        >
          <div class="container-fluid">
            <!-- Logo and app name -->
            <a class="navbar-brand" href="#" @click.prevent="go('home')">
              <img
                :src="darkMode? logo.darkMode : logo.lightMode"
                alt="Logo"
                width="40"
                height="35"
                class="d-inline-block align-text-middle"
              />
              XLearning
            </a>

            <!-- Toggle menu icon -->
            <button
              class="navbar-toggler dropdown"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Action</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>

            <!-- Navigation links logic -->
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <div class="navbar-nav">
                <a
                  :class="[ 'nav-link', isActive('home') ]"
                  :aria-current="isActive('home') ? 'page' : null"
                  href="#"
                  @click.prevent="go('home')"
                  >Home
                </a>
                <a
                  :class="[ 'nav-link', isActive('checkout') ]"
                  :aria-current="isActive('checkout') ? 'page' : null"
                  href="#"
                  @click.prevent="go('checkout')"
                  >Browse
                </a>

                <a
                  :class="[ 'nav-link', isActive('dashboard') ]"
                  :aria-current="isActive('dashboard') ? 'page' : null"
                  href="#"
                  @click.prevent="go('dashboard')"
                  >Dashboard
                </a>
              </div>

              <div class="d-flex align-items-start-end gap-3 ms-auto">
                <!-- Dark mode toggle button -->
                <form class="d-flex">
                  <button
                    type="button"
                    :class="['btn', 'btn-sm', darkMode ? 'active toggle-dark-button' : 'active toggle-white-button']"
                    @click="toggleTheme()"
                    data-bs-toggle="button"
                    aria-pressed="true"
                  >
                    Dark Mode
                  </button>
                </form>

                <!-- Search bar -->
                <form class="d-flex me-2" role="search">
                  <input
                    class="form-control me-2"
                    type="search"
                    placeholder="Search"
                    aria-label="Search"
                  />
                  <button class="btn btn-outline-success" type="submit">
                    Search
                  </button>
                </form>

                <!-- <Log in and Log out buttons -->
                <form class="d-flex" role="sign-in">
                  <button
                    type="button"
                    class="btn btn-light btn-sm"
                    v-if="!userLoginStatus.isUserLoggedIn"
                  >
                    Sign In
                  </button>
                  <button
                    type="button"
                    class="btn btn-light btn-sm"
                    v-if="userLoginStatus.isUserLoggedIn"
                  >
                    Log Out
                    <span class="fa-solid fa-arrow-right-from-bracket"></span>
                  </button>
                </form>
              </div>
            </div>
          </div>
        </nav>

        <!-- Sub-header -->
        <div id="subheader" class="card">
          <div
            class="card-header d-flex justify-content-between align-items-center"
          >
            <button
              id="sidebar_hamburger"
              type="button"
              data-bs-toggle="offcanvas"
              data-bs-target="#offcanvasScrolling"
              aria-controls="offcanvasScrolling"
            >
              <span class="fa-solid fa-bars"></span>
            </button>

            <!-- Checkout button -->
            <div id="checkoutbutton">
              <button class="btn btn-success" :disabled="!(itemsInCartLength>0)" @click.prevent = "isActive('checkout') ? go('home') : go('checkout')">
                <span v-if="itemsInCartLength>0">
                  <i class="fa-solid fa-cart-shopping"></i>
                  Checkout ({{itemsInCartLength}})
                </span>
                <span v-else>
                  <i class="fa-solid fa-cart-shopping"></i>
                  Checkout
                </span>
              </button>
            </div>

            <!-- Offcanvas Sidebar -->
            <div
              class="offcanvas offcanvas-start"
              data-bs-scroll="true"
              data-bs-backdrop="false"
              tabindex="-1"
              id="offcanvasScrolling"
              aria-labelledby="offcanvasScrollingLabel"
            >
              <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="offcanvasScrollingLabel">
                  Filter
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="offcanvas"
                  aria-label="Close"
                ></button>
              </div>

              <!-- Sidebar contents -->
              <div class="offcanvas-body">
                <!-- 
                REQUIREMENT [Front-End] Sort functionality: 
                -->
                
                <!-- Sort container -->
                <div class="container-fluid" id="sortContainer">
                  <!-- Sort attributes dropdown -->
                  <div>
                    <label for="sortBy" class="form-label">Sort By</label>
                    <select
                      class="form-select"
                      id="sortBy"
                      v-model="sortAttribute"
                    >
                      <option disabled value="">Select an attribute</option>
                      <option value="subject">Subject</option>
                      <option value="location">Location</option>
                      <option value="price">Price</option>
                      <option value="available">Spaces</option>
                    </select>
                  </div>

                  <!-- Sort order -->
                  <div class="mt-3" id="sortOrder">
                    <input
                      type="radio"
                      id="sortOrderAsc"
                      value="asc"
                      v-model="sortOrder"
                    />
                    <label for="sortOrderAsc">Ascending</label>

                    <input
                      type="radio"
                      id="sortOrderDesc"
                      value="desc"
                      v-model="sortOrder"
                    />
                    <label for="sortOrderDesc">Descending</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Conditional rendering of pages -->
      <!-- Home Page -->
      <div v-if="currentView === 'home'">
        <div class="container-fluid" id="main_content_container">
          <div class="row mt-4">
            <!-- 
            REQUIREMENT [Front-End] “Display List of Lessons” functionality:
            -->
            <div
              class="col-md-3 mb-4"
              v-for="lesson in sortedLessons"
              :key="lesson.id"
            >
              <div id="lesson_card" class="card h-100 shadow-sm d-flex flex-column">
                <img
                  :src="lesson.img"
                  class="card-img-top"
                  alt="Lesson Image"
                />
                <div class="card-body text-center">
                  <div id="lesson_title">
                    <h5 class="card-title">{{ lesson.subject }}</h5>
                  </div>

                  <div class="card-text">
                    <!-- Lesson description -->
                    <div id="lesson_description">
                      {{ lesson.description }}
                    </div>

                    <!-- Lesson Info -->
                    <div class="lesson_info">

                      <!-- Location -->
                      <div id="lesson_location"></div>
                      <span>
                        <i class="fa-solid fa-location-dot"></i> Venue: {{lesson.location}}
                      </span><br>

                      <!-- Spaces available -->
                      <div id="space_available" class="mt-2">
                        <span v-if="itemsLeft(lesson)>0" id="items_left">Only {{itemsLeft(lesson)}} seats left! <br>
                          <span>
                            Secure yours now at only 
                            <span id="lesson_price">$ {{lesson.price}}</span>
                          </span>
                        </span>
                        <span v-else id="outOfStockText" >Out of stock</span>
                      </div>
                    </div>
                  </div>

                  <!-- Add Cart Button: Only visible when space is larger than 0. -->
                  <div class="text-center pb-2 mt-3">
                    <button 
                      id="addToCartBtn"
                      @click="addToCart(lesson)" 
                      :disabled="!canAddToCart(lesson)"
                    >
                      Add To Cart
                    </button>
                    <span>
                      <button>
                        <i class="fa-solid fa-cart-plus"></i>
                        {{numberOfItemInCart(lesson.id)}}
                      </button>
                    </span>
                    <span>
                      <button v-show="numberOfItemInCart(lesson.id)>0" @click="removeLessonFromCart(lesson)">
                        <i class="fa-solid fa-minus"></i>
                      </button>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Checkout Page -->
      <div v-if="currentView === 'checkout'">
        <div class="container-fluid">
          <h2>Checkout page</h2>
        </div>
      </div>

      <div v-if="currentView === 'dashboard'">
        <div class="container-fluid" id="main_content_container">
          <h2>Dashboard</h2>
          <p>User info and stats...</p>
        </div>
      </div>

      <!-- End of main app. -->
    </div>

    <!--Main app script-->
    <script src="./js/main.js"></script>
  </body>
</html>
